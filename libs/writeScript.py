#!/usr/bin/python3
# @File:.py
# -*- coding:utf-8 -*-
# @Author:von_fan
# @Time:2020年06月05日00时30分34秒

import  re,os,json
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
class MakeScript(object):
    def __init__(self):
        self.classSample=open("{}/interface/CaseScriptSample/classSample.py".format(BASE_DIR),"r",encoding="utf8")
        self.importSample=open("{}/interface/CaseScriptSample/importSample.py".format(BASE_DIR),"r",encoding="utf8")
        self.methodSample=open("{}/interface/CaseScriptSample/methodSample.py".format(BASE_DIR),"r",encoding="utf8")
        # self.file=open("{}/interface/test_all.py".format(BASE_DIR),"a",encoding='utf8')

        self.classSampleText=self.classSample.readlines()
        self.importSampleText = self.importSample.readlines()
        self.methodSampleText = self.methodSample.readlines()
    def write(self, s):
        pass

    def make_replace_class(self,classNameC,order):

        for text  in self.classSampleText:
             if "class_name_code"  in   text:   #进行类名替换

                 text=text.replace("class_name_code","TestCase_{}".format(order.zfill(7)))
             if  "__class_name__"  in text:
                 text =text.replace("__class_name__",classNameC)  #替换unittest获取的类名
             self.makeFile.write(text)
    def make_replace_import(self):
        for text  in  self.importSampleText:
            self.makeFile.write(text)

    def make_replace_method(self,row):
        for text in self.methodSampleText:
            if "__method_name__" in text:
                text =text.replace("__method_name__",row["name"])
            # if "暂无注释" in text:
            #     if row["detail"]:
            #         text = text.replace("暂无注释", "{}".format(row["detail"]))
            if "test_method_name" in text:
                text =text.replace("test_method_name","test_{}".format(str(row["order"]).zfill(7)))
            if "data={}" in text:
                text=text.replace("data={}","data=%s"%(row))
            self.makeFile.write(text)
        #以下是数据库存的断言数据[{post:1,res:2},{}]  断言post与res的区别--如果列表存在多个则遍历添加断言
        #前端填写断言格式为res["xxx"]
        self.makeFile.write("        self.assertEqual({}, {})\n".format(200,"res['resText']['status']"))

        #写入断言--数据库直接存 assertEqual(a, b)  这种格式
    def writelines(self, lines):
        pass

    def make_close(self):
        self.makeFile.close()
        self.classSample.close()
        self.methodSample.close()
        self.importSample.close()

    def start_write(self):
        pass
    def order_data(self,data):
        return  sorted(data,key=lambda data:data["order"])
    def make_file(self,data,name):
        """执行函数"""

        self.makeFile=open("{}/interface/testFiles/{}.py".format(BASE_DIR,name),"a",encoding="utf8")
        #添加import
        self.make_replace_import()
        for item in data:
            print("_____", item, "________________")
            if len(item["child"])>0:
                #创建一个class

                self.make_replace_class(item["name"],str(item["order"]))
                #如果该接口下存在用例--则第一步是给该接口下的所有用例排序
                interfaceCaseList=self.order_data(item["child"])
                for  row in  interfaceCaseList:
                    #创建用例def
                    # {'child': [{'name': '登录注册', 'order': 11, 'status': {'id': 0, 'name': '未完成'}, 'postMethod': 1, 'dataType': 3, 'attr': '/login/test/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': ''}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': ''}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': ''}, {'headerKey': 'Authorization', 'headerValue': ' JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MDk5NTg2MSwiZW1haWwiOiIifQ.pfkXSxxzyOMEreVJIxRlOtbaSadpPJTux1SWQNR7wUw', 'headerDetail': ''}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': ''}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': ''}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': ''}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': ''}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': ''}]}, 'data': {'keys': [{'isRequestsData': 'true', 'dataKey': '', 'dataValue': '', 'dataDetail': ''}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': '获取项目列表', 'order': 2, 'status': {'id': 1, 'name': '已完成'}, 'postMethod': 1, 'dataType': 1, 'attr': 'http://192.168.0.66:8081/users/project_list/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': ''}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': ''}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': ''}, {'headerKey': 'Authorization', 'headerValue': '{{token}}', 'headerDetail': ''}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': ''}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': ''}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': ''}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': ''}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': ''}]}, 'data': {'keys': [{'isRequestsData': True, 'dataKey': '', 'dataValue': '', 'dataDetail': '', 'key': 1590479638107}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': '登录', 'order': 19, 'status': {'id': 1, 'name': '已完成'}, 'postMethod': 2, 'dataType': 1, 'attr': 'http://192.168.0.66:8080/users/login/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': '', 'key': 1590568909903}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': '', 'key': 1590568909903}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': '', 'key': 1590568909903}, {'headerKey': 'Authorization', 'headerValue': ' JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MDk5NTg2MSwiZW1haWwiOiIifQ.pfkXSxxzyOMEreVJIxRlOtbaSadpPJTux1SWQNR7wUw', 'headerDetail': '', 'key': 1590568909903}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': '', 'key': 1590568909903}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': '', 'key': 1590568909903}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': '', 'key': 1590568909903}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': '', 'key': 1590568909903}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': '', 'key': 1590568909903}]}, 'data': {'keys': [{'isRequestsData': True, 'dataKey': 'username', 'dataValue': '13590283182', 'dataDetail': '', 'key': 1590568909904}, {'isRequestsData': True, 'dataKey': 'password', 'dataValue': 'ff123456', 'dataDetail': '', 'key': 1590568909904}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': '更新', 'order': 1, 'status': {'id': 0, 'name': '未完成'}, 'postMethod': 2, 'dataType': 1, 'attr': '/login/test/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': '', 'key': 1591863945393}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': '', 'key': 1591863945393}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': '', 'key': 1591863945393}, {'headerKey': 'Authorization', 'headerValue': ' JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MDk5NTg2MSwiZW1haWwiOiIifQ.pfkXSxxzyOMEreVJIxRlOtbaSadpPJTux1SWQNR7wUw', 'headerDetail': '', 'key': 1591863945393}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': '', 'key': 1591863945393}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': '', 'key': 1591863945393}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': '', 'key': 1591863945393}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': '', 'key': 1591863945393}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': '', 'key': 1591863945393}]}, 'data': {'keys': [{'isRequestsData': 'true', 'dataKey': 'status', 'dataValue': '0', 'dataDetail': '', 'key': 1591863945393}, {'isRequestsData': 'true', 'dataKey': 'msg', 'dataValue': '操作成功', 'dataDetail': '', 'key': 1591863945393}, {'isRequestsData': 'true', 'dataKey': 'result', 'dataValue': '', 'dataDetail': '', 'key': 1591863945393}, {'isRequestsData': 'true', 'dataKey': 'cao', 'dataValue': '1', 'dataDetail': '', 'key': 1591863945393}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': 'xinzeng', 'order': 17, 'status': {'id': 0, 'name': '未完成'}, 'postMethod': 1, 'dataType': 1, 'attr': '/login/test/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': '', 'key': 1591863998157}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': '', 'key': 1591863998157}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': '', 'key': 1591863998158}, {'headerKey': 'Authorization', 'headerValue': ' JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MDk5NTg2MSwiZW1haWwiOiIifQ.pfkXSxxzyOMEreVJIxRlOtbaSadpPJTux1SWQNR7wUw', 'headerDetail': '', 'key': 1591863998158}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': '', 'key': 1591863998158}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': '', 'key': 1591863998158}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': '', 'key': 1591863998158}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': '', 'key': 1591863998158}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': '', 'key': 1591863998158}]}, 'data': {'keys': [{'isRequestsData': 'true', 'dataKey': 'status', 'dataValue': '0', 'dataDetail': '', 'key': 1591863998158}, {'isRequestsData': 'true', 'dataKey': 'msg', 'dataValue': '操作成功', 'dataDetail': '', 'key': 1591863998158}, {'isRequestsData': 'true', 'dataKey': 'result', 'dataValue': '', 'dataDetail': '', 'key': 1591863998158}, {'isRequestsData': 'true', 'dataKey': 'cao', 'dataValue': '1', 'dataDetail': '', 'key': 1591863998158}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': '获取项目列表', 'order': 5, 'status': {'id': 1, 'name': '已完成'}, 'postMethod': 1, 'dataType': 1, 'attr': 'http://192.168.0.66:8081/users/project_list/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': ''}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': ''}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': ''}, {'headerKey': 'Authorization', 'headerValue': '{{token}}', 'headerDetail': ''}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': ''}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': ''}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': ''}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': ''}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': ''}]}, 'data': {'keys': [{'isRequestsData': True, 'dataKey': '', 'dataValue': '', 'dataDetail': '', 'key': 1590479638107}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': '获取项目列表', 'order': 6, 'status': {'id': 1, 'name': '已完成'}, 'postMethod': 1, 'dataType': 1, 'attr': 'http://192.168.0.66:8081/users/project_list/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': ''}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': ''}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': ''}, {'headerKey': 'Authorization', 'headerValue': '{{token}}', 'headerDetail': ''}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': ''}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': ''}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': ''}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': ''}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': ''}]}, 'data': {'keys': [{'isRequestsData': True, 'dataKey': '', 'dataValue': '', 'dataDetail': '', 'key': 1590479638107}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': '获取项目列表', 'order': 7, 'status': {'id': 1, 'name': '已完成'}, 'postMethod': 1, 'dataType': 1, 'attr': 'http://192.168.0.66:8081/users/project_list/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': ''}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': ''}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': ''}, {'headerKey': 'Authorization', 'headerValue': '{{token}}', 'headerDetail': ''}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': ''}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': ''}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': ''}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': ''}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': ''}]}, 'data': {'keys': [{'isRequestsData': True, 'dataKey': '', 'dataValue': '', 'dataDetail': '', 'key': 1590479638107}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': '获取项目列表', 'order': 8, 'status': {'id': 1, 'name': '已完成'}, 'postMethod': 1, 'dataType': 1, 'attr': 'http://192.168.0.66:8081/users/project_list/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': ''}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': ''}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': ''}, {'headerKey': 'Authorization', 'headerValue': '{{token}}', 'headerDetail': ''}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': ''}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': ''}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': ''}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': ''}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': ''}]}, 'data': {'keys': [{'isRequestsData': True, 'dataKey': '', 'dataValue': '', 'dataDetail': '', 'key': 1590479638107}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': '获取项目列表', 'order': 9, 'status': {'id': 1, 'name': '已完成'}, 'postMethod': 1, 'dataType': 1, 'attr': 'http://192.168.0.66:8081/users/project_list/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': ''}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': ''}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': ''}, {'headerKey': 'Authorization', 'headerValue': '{{token}}', 'headerDetail': ''}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': ''}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': ''}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': ''}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': ''}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': ''}]}, 'data': {'keys': [{'isRequestsData': True, 'dataKey': '', 'dataValue': '', 'dataDetail': '', 'key': 1590479638107}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': '获取项目列表', 'order': 12, 'status': {'id': 1, 'name': '已完成'}, 'postMethod': 1, 'dataType': 1, 'attr': 'http://192.168.0.66:8081/users/project_list/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': ''}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': ''}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': ''}, {'headerKey': 'Authorization', 'headerValue': '{{token}}', 'headerDetail': ''}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': ''}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': ''}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': ''}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': ''}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': ''}]}, 'data': {'keys': [{'isRequestsData': True, 'dataKey': '', 'dataValue': '', 'dataDetail': '', 'key': 1590479638107}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': '获取项目列表', 'order': 13, 'status': {'id': 1, 'name': '已完成'}, 'postMethod': 1, 'dataType': 1, 'attr': 'http://192.168.0.66:8081/users/project_list/', 'detail': None, 'headers': {'keys': [{'headerKey': 'Accept', 'headerValue': ' application/json, text/plain, */*', 'headerDetail': ''}, {'headerKey': 'Accept-Encoding', 'headerValue': ' gzip, deflate', 'headerDetail': ''}, {'headerKey': 'Accept-Language', 'headerValue': ' zh-CN,zh;q=0.9', 'headerDetail': ''}, {'headerKey': 'Authorization', 'headerValue': '{{token}}', 'headerDetail': ''}, {'headerKey': 'Connection', 'headerValue': ' keep-alive', 'headerDetail': ''}, {'headerKey': 'Cookie', 'headerValue': ' csrftoken=W2qkPBcyrD4s7KReRKIiZNfsnLoLVv7TinPtRTiDQDIAOui2b3K3VEYyMeLGBvdF', 'headerDetail': ''}, {'headerKey': 'Host', 'headerValue': ' 192.168.0.66', 'headerDetail': ''}, {'headerKey': 'Referer', 'headerValue': ' http', 'headerDetail': ''}, {'headerKey': 'User-Agent', 'headerValue': ' Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36', 'headerDetail': ''}]}, 'data': {'keys': [{'isRequestsData': True, 'dataKey': '', 'dataValue': '', 'dataDetail': '', 'key': 1590479638107}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}, {'name': '234', 'order': 20, 'status': {'id': 0, 'name': '未完成'}, 'postMethod': 2, 'dataType': 1, 'attr': '3321', 'detail': '3123', 'headers': {'keys': [{'headerKey': '', 'headerValue': '', 'headerDetail': ''}]}, 'data': {'keys': [{'isRequestsData': 'true', 'dataKey': '', 'dataValue': '', 'dataDetail': ''}]}, 'environmentId': {'environment': [], 'global': [{'token': 'JWT eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxNCwidXNlcm5hbWUiOiIxMzU5MDI4MzE4MiIsImV4cCI6MTU5MjUzNDQ1OSwiZW1haWwiOiIifQ.CohJRy2I_n84bvtzmAzZUIf3y9Omg_IS1z7bebDTzFY'}, {'点点点': '点点点'}]}}], 'name': 'deng1', 'order': 1} ________________
                    print(row)
                    if row["status"]["id"]:

                        self.make_replace_method(row)



            else:
                pass
                #如果只有文件没有内容的---考虑是否处理-后面再说
        self.makeFile.flush()
        self.make_close()
if __name__=="__main__":
    files=MakeScript()




